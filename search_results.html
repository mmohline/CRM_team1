{{extend 'layout.html'}}
<h1>Contacts Search Results</h1>
 <form action="http://127.0.0.1:8000/TTK/contacts/view">
         <button type="submit">Return</button>
      </form>
{{sterm = "%" + session.sterm + "%"}}
{{print(sterm)}}
<table class="table table-striped table-hover">
    <tr>
        <th>Name</th>
        <th>Company</th>
        <th>Address</th>
        <th>City</th>
        <th>State</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>Email</th>
        <th>Date</th>
        <th>Office Location</th>
        <th>Office Phone</th>
        <th>Contact Type</th>
    </tr>
{{rows = db((db.contacts.first_name.ilike(sterm)) | (db.contacts.last_name.ilike(sterm))).select()}}
{{if len(rows)==0:}}
    <tr>
     <td colspan="3">No matching records</td>
 </tr>
    {{else:}}
    {{for row in rows:}}
     <tr>
        <td><a href="/{{=request.application}}/{{=request.controller}}/update/{{=row.id}}">{{=row.first_name}}, {{=row.last_name}}</a></td>
        <td>{{=row.company}}</td>
        <td>{{=row.address}}</td>
        <td>{{row.city}}</td>
        <td>{{=row.state_name}}</td>
        <td>{{=row.zip}}</td>
        <td>{{=row.phone}}</td>
        <td>{{=row.email}}</td>
        <td>{{=row.date_created}}</td>
        <td>{{=row.office_location}}</td>
        <td>{{=row.office_phone}}</td>
        <td>{{=row.contact}}</td>
     </tr>
    {{pass}}
{{pass}}
</table>